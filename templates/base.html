{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Avto-Декор{% endblock %}</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="{% block meta_description %}{{ default_description }}{% endblock %}">
    <meta name="keywords" content="{% block meta_keywords %}{{ default_keywords }}{% endblock %}">
    <meta name="author" content="Avto-Декор">
    <meta name="robots" content="{% block meta_robots %}index, follow{% endblock %}">
    <link rel="canonical" href="{% block canonical_url %}{{ canonical_url }}{% endblock %}">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="{% block og_type %}website{% endblock %}">
    <meta property="og:url" content="{% block og_url %}{{ canonical_url }}{% endblock %}">
    <meta property="og:title" content="{% block og_title %}Avto-Декор{% endblock %}">
    <meta property="og:description" content="{% block og_description %}{{ default_description }}{% endblock %}">
    <meta property="og:site_name" content="{{ site_name }}">
    {% block og_image %}{% if request.resolver_match.url_name == 'home' %}<meta property="og:image" content="{{ site_url }}{% static 'img/Logo.png' %}">{% endif %}{% endblock %}
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="{% block twitter_url %}{{ canonical_url }}{% endblock %}">
    <meta name="twitter:title" content="{% block twitter_title %}Avto-Декор{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}{{ default_description }}{% endblock %}">
    {% block twitter_image %}{% if request.resolver_match.url_name == 'home' %}<meta name="twitter:image" content="{{ site_url }}{% static 'img/Logo.png' %}">{% endif %}{% endblock %}
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'img/Logo.ico' %}?v=3">
    <link rel="shortcut icon" href="{% static 'img/Logo.ico' %}?v=3">
    <link rel="apple-touch-icon" href="{% static 'img/Logo.ico' %}?v=3">
    
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        // Кастомные цвета из брендбука
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        red: {
                            700: '#9C111F', // RGB: 156, 17, 31 - Основной темно-бордовый
                            800: '#7D0C1B', // RGB: 125, 12, 27 - Темный приглушенный бордовый
                            900: '#7D0C1B', // RGB: 125, 12, 27 - Для границ и фонов
                        }
                    }
                }
            }
        }
    </script>
    
    <style>
        * {
            box-sizing: border-box;
        }
        
        html {
            overflow-x: hidden;
            width: 100%;
        }
        
        body {
            background: linear-gradient(to bottom right, #111827, #000000, #111827);
            overflow-x: hidden;
            width: 100%;
            max-width: 100vw;
        }
        
        /* Предотвращение выхода элементов за границы */
        img, video, iframe {
            max-width: 100% !important;
            height: auto !important;
        }
        
        /* Адаптивность фоновых изображений */
        [style*="background-image"] {
            background-size: cover !important;
            background-position: center !important;
            background-repeat: no-repeat !important;
        }
        
        /* Исправление для карточек услуг */
        .group.relative.overflow-hidden img,
        .group.relative.overflow-hidden [style*="background-image"] {
            max-width: 100% !important;
            width: 100% !important;
            object-fit: cover !important;
        }
        
        /* Исключение для логотипов - они не должны растягиваться */
        img[alt="Avto-Декор"], img[alt*="Avto"], header img, footer img {
            max-width: none !important;
            width: auto !important;
            object-fit: contain !important;
        }
        
        /* Явное ограничение размера логотипа в header */
        header img[alt="Avto-Декор"] {
            max-width: 150px !important;
            height: auto !important;
        }
        
        /* Логотип в footer */
        footer img[alt="Avto-Декор"] {
            max-width: 120px !important;
            height: auto !important;
        }
        
        /* Ограничение максимальной ширины контейнера для лучшей читаемости */
        .container {
            max-width: 1200px !important;
            width: 100%;
            padding-left: 1rem;
            padding-right: 1rem;
        }
        
        /* Header должен быть шире основного контента */
        header .container {
            max-width: 1400px !important;
        }
        
        /* Адаптивность для мобильных устройств */
        @media (max-width: 640px) {
            .container {
                padding-left: 0.75rem !important;
                padding-right: 0.75rem !important;
            }
            
            /* Предотвращение переполнения текста */
            h1, h2, h3, h4, h5, h6, p, span, div, a, button {
                word-wrap: break-word;
                overflow-wrap: break-word;
                hyphens: auto;
            }
            
            /* Ограничение ширины кнопок и форм */
            button, a, input, textarea, select {
                max-width: 100%;
                box-sizing: border-box;
            }
            
            /* Уменьшение отступов на мобильных */
            section {
                padding-left: 0.75rem !important;
                padding-right: 0.75rem !important;
            }
            
            /* Исправление переполнения для grid и flex */
            .grid, .flex {
                max-width: 100%;
                overflow-x: hidden;
            }
            
            /* Исправление карточек */
            .rounded-lg, .rounded-xl, .rounded-2xl {
                max-width: 100%;
                overflow: hidden;
            }
        }
        
        /* Дополнительные исправления для планшетов */
        @media (min-width: 641px) and (max-width: 1024px) {
            .container {
                padding-left: 1rem !important;
                padding-right: 1rem !important;
            }
            
            h1, h2, h3, h4, h5, h6, p, span, div, a, button {
                word-wrap: break-word;
                overflow-wrap: break-word;
            }
        }
        
        /* Адаптивность для средних экранов (около 1478px) */
        @media (min-width: 1200px) and (max-width: 1600px) {
            .container {
                max-width: 1100px !important;
                padding-left: 1.5rem !important;
                padding-right: 1.5rem !important;
            }
            
            /* Header должен быть шире */
            header .container {
                max-width: 1400px !important;
                padding-left: 2rem !important;
                padding-right: 2rem !important;
            }
            
            /* Уменьшаем размеры шрифтов */
            h1 {
                font-size: 2.5rem !important;
            }
            
            h2 {
                font-size: 2rem !important;
            }
            
            /* Уменьшаем отступы */
            section {
                padding-top: 3rem !important;
                padding-bottom: 3rem !important;
            }
            
            /* Hero-секция с автоматической высотой */
            section.relative.min-h-\[400px\] {
                min-height: 400px !important;
            }
        }
        
        /* Улучшение навигации на средних экранах */
        @media (min-width: 1024px) and (max-width: 1600px) {
            nav ul li a {
                font-size: 0.7rem !important;
                padding: 0.75rem 0.25rem !important;
            }
        }
        
        /* Ограничение ширины для больших секций */
        @media (min-width: 1280px) {
            section.container {
                max-width: 1100px !important;
            }
        }
    </style>
    
    {% block extra_css %}{% endblock %}
    
    <!-- Yandex.Metrika counter -->
    <script type="text/javascript">
        (function(m,e,t,r,i,k,a){
            m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
            m[i].l=1*new Date();
            for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
            k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
        })(window, document,'script','https://mc.yandex.ru/metrika/tag.js', 'ym');

        ym(23317828, 'init', {webvisor:true, clickmap:true, ecommerce:"dataLayer", referrer: document.referrer, url: location.href, accurateTrackBounce:true, trackLinks:true});
    </script>
    <noscript><div><img src="https://mc.yandex.ru/watch/23317828" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
    <!-- /Yandex.Metrika counter -->
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900">
    <!-- Header -->
    <header class="bg-black/50 backdrop-blur-md border-b border-red-900/20 sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between py-4">
                <!-- Logo -->
                <a href="{% url 'core:home' %}" class="flex items-center">
                    <img 
                        src="{% static 'img/Logo.png' %}?v=2" 
                        alt="Avto-Декор" 
                        class="h-8 sm:h-10 md:h-12"
                        style="max-width: 150px; width: auto; height: auto;"
                    />
                </a>

                <!-- Desktop Contact & Mobile Burger -->
                <div class="flex items-center gap-4">
                    <!-- Desktop Social Links -->
                    <div class="hidden md:flex items-center gap-3">
                        <!-- Telegram -->
                        <a 
                            href="https://t.me/avtodecorptz" 
                            target="_blank"
                            rel="noopener noreferrer"
                            class="flex items-center justify-center w-10 h-10 bg-red-700 hover:bg-red-800 transition-colors rounded-lg"
                            aria-label="Telegram"
                        >
                            <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                            </svg>
                        </a>
                        <!-- VK -->
                        <a 
                            href="https://vk.ru/avto_decor" 
                            target="_blank"
                            rel="noopener noreferrer"
                            class="flex items-center justify-center w-10 h-10 bg-red-700 hover:bg-red-800 transition-colors rounded-lg text-white font-bold text-sm"
                            aria-label="ВКонтакте"
                        >
                            ВК
                        </a>
                    </div>
                    <!-- Desktop Contact -->
                    <div class="hidden md:flex items-center gap-3">
                        <button 
                            onclick="openContactModal()"
                            class="flex items-center gap-2 bg-gray-800 hover:bg-gray-700 transition-colors px-6 py-3 rounded-lg text-white"
                        >
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>Оставить заявку</span>
                        </button>
                        <a 
                            href="tel:+79212282301" 
                            class="flex items-center gap-2 bg-red-700 hover:bg-red-800 transition-colors px-6 py-3 rounded-lg"
                        >
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            <span>+7 (921) 228-23-01</span>
                        </a>
                    </div>

                    <!-- Mobile Burger Menu Button -->
                    <button 
                        id="mobile-menu-button"
                        class="md:hidden flex items-center justify-center w-10 h-10 text-white hover:bg-red-900/30 rounded-lg transition-colors"
                        aria-label="Меню"
                    >
                        <svg id="menu-icon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                        <svg id="close-icon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Desktop Navigation -->
            <nav class="hidden md:block border-t border-red-900/20">
                <ul class="flex gap-0">
                    {% url 'core:home' as home_url %}
                    <li class="flex-1">
                        <a
                            href="{{ home_url }}"
                            class="block px-4 py-4 text-center transition-colors {% if request.path == home_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                        >
                            ГЛАВНАЯ
                        </a>
                    </li>
                    {% url 'core:about' as about_url %}
                    <li class="flex-1">
                        <a
                            href="{{ about_url }}"
                            class="block px-4 py-4 text-center transition-colors {% if request.path == about_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                        >
                            О СТУДИИ
                        </a>
                    </li>
                    {% url 'services:list' as services_url %}
                    <li class="flex-1">
                        <a
                            href="{{ services_url }}"
                            class="block px-4 py-4 text-center transition-colors {% if request.path|slice:':7' == '/uslugi' %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                        >
                            УСЛУГИ
                        </a>
                    </li>
                    {% url 'works:list' as works_url %}
                    <li class="flex-1">
                        <a
                            href="{{ works_url }}"
                            class="block px-4 py-4 text-center transition-colors {% if request.path == works_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                        >
                            НАШИ РАБОТЫ
                        </a>
                    </li>
                    {% url 'reviews:list' as reviews_url %}
                    <li class="flex-1">
                        <a
                            href="{{ reviews_url }}"
                            class="block px-4 py-4 text-center transition-colors {% if request.path == reviews_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                        >
                            ОТЗЫВЫ
                        </a>
                    </li>
                    {% url 'articles:list' as articles_url %}
                    <li class="flex-1">
                        <a
                            href="{{ articles_url }}"
                            class="block px-4 py-4 text-center transition-colors {% if request.path|slice:':6' == '/stati' %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                        >
                            НОВОСТИ
                        </a>
                    </li>

                    {% url 'contacts:contacts' as contacts_url %}
                    <li class="flex-1">
                        <a
                            href="{{ contacts_url }}"
                            class="block px-4 py-4 text-center transition-colors {% if request.path == contacts_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                        >
                            КОНТАКТЫ
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- Mobile Navigation (Burger Menu) -->
            <nav 
                id="mobile-menu"
                class="md:hidden border-t border-red-900/20 hidden overflow-hidden transition-all duration-300 ease-in-out"
            >
                <ul class="flex flex-col">
                    {% url 'core:home' as home_url %}
                    <li>
                        <a
                            href="{{ home_url }}"
                            class="block px-4 py-3 text-center transition-colors {% if request.path == home_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                            onclick="closeMobileMenu()"
                        >
                            ГЛАВНАЯ
                        </a>
                    </li>
                    {% url 'services:list' as services_url %}
                    <li>
                        <a
                            href="{{ services_url }}"
                            class="block px-4 py-3 text-center transition-colors {% if request.path|slice:':7' == '/uslugi' %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                            onclick="closeMobileMenu()"
                        >
                            УСЛУГИ
                        </a>
                    </li>
                    {% url 'works:list' as works_url %}
                    <li>
                        <a
                            href="{{ works_url }}"
                            class="block px-4 py-3 text-center transition-colors {% if request.path == works_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                            onclick="closeMobileMenu()"
                        >
                            НАШИ РАБОТЫ
                        </a>
                    </li>
                    {% url 'reviews:list' as reviews_url %}
                    <li>
                        <a
                            href="{{ reviews_url }}"
                            class="block px-4 py-3 text-center transition-colors {% if request.path == reviews_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                            onclick="closeMobileMenu()"
                        >
                            ОТЗЫВЫ
                        </a>
                    </li>
                    {% url 'articles:list' as articles_url %}
                    <li>
                        <a
                            href="{{ articles_url }}"
                            class="block px-4 py-3 text-center transition-colors {% if request.path|slice:':6' == '/stati' %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                            onclick="closeMobileMenu()"
                        >
                            НОВОСТИ
                        </a>
                    </li>
                    {% url 'core:about' as about_url %}
                    <li>
                        <a
                            href="{{ about_url }}"
                            class="block px-4 py-3 text-center transition-colors {% if request.path == about_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                            onclick="closeMobileMenu()"
                        >
                            О СТУДИИ
                        </a>
                    </li>
                    {% url 'contacts:contacts' as contacts_url %}
                    <li>
                        <a
                            href="{{ contacts_url }}"
                            class="block px-4 py-3 text-center transition-colors {% if request.path == contacts_url %}bg-red-700 text-white{% else %}text-gray-300 hover:bg-red-900/30 hover:text-white{% endif %}"
                            onclick="closeMobileMenu()"
                        >
                            КОНТАКТЫ
                        </a>
                    </li>
                    <!-- Mobile Social Links -->
                    <li class="border-t border-red-900/20">
                        <div class="flex items-center justify-center gap-3 px-4 py-3">
                            <!-- Telegram -->
                            <a
                                href="https://t.me/avtodecorptz"
                                target="_blank"
                                rel="noopener noreferrer"
                                class="flex items-center justify-center w-10 h-10 bg-red-700 hover:bg-red-800 transition-colors rounded-lg"
                                aria-label="Telegram"
                                onclick="closeMobileMenu()"
                            >
                                <svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M11.944 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0a12 12 0 0 0-.056 0zm4.962 7.224c.1-.002.321.023.465.14a.506.506 0 0 1 .171.325c.016.093.036.306.02.472-.18 1.898-.962 6.502-1.36 8.627-.168.9-.499 1.201-.82 1.23-.696.065-1.225-.46-1.9-.902-1.056-.693-1.653-1.124-2.678-1.8-1.185-.78-.417-1.21.258-1.91.177-.184 3.247-2.977 3.307-3.23.007-.032.014-.15-.056-.212s-.174-.041-.249-.024c-.106.024-1.793 1.14-5.061 3.345-.48.33-.913.49-1.302.48-.428-.008-1.252-.241-1.865-.44-.752-.245-1.349-.374-1.297-.789.027-.216.325-.437.893-.663 3.498-1.524 5.83-2.529 6.998-3.014 3.332-1.386 4.025-1.627 4.476-1.635z"/>
                                </svg>
                            </a>
                            <!-- VK -->
                            <a
                                href="https://vk.ru/avto_decor"
                                target="_blank"
                                rel="noopener noreferrer"
                                class="flex items-center justify-center w-10 h-10 bg-red-700 hover:bg-red-800 transition-colors rounded-lg text-white font-bold text-sm"
                                aria-label="ВКонтакте"
                                onclick="closeMobileMenu()"
                            >
                                ВК
                            </a>
                        </div>
                    </li>
                    <!-- Mobile Contact -->
                    <li class="border-t border-red-900/20">
                        <button
                            onclick="openContactModal(); closeMobileMenu();"
                            class="w-full flex items-center justify-center gap-2 px-4 py-3 bg-gray-800 hover:bg-gray-700 transition-colors text-white"
                        >
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                            </svg>
                            <span>Оставить заявку</span>
                        </button>
                    </li>
                    <li>
                        <a
                            href="tel:+79212282301"
                            class="flex items-center justify-center gap-2 px-4 py-3 bg-red-700 hover:bg-red-800 transition-colors text-white"
                            onclick="closeMobileMenu()"
                        >
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            <span>+7 (921) 228-23-01</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-black/80 border-t border-red-900/20 mt-20">
        <div class="container mx-auto px-4 py-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <img 
                        src="{% static 'img/Logo.png' %}?v=2" 
                        alt="Avto-Декор" 
                        class="h-8 sm:h-10 mb-4"
                        style="max-width: 120px; width: auto; height: auto;"
                    />
                    <p class="text-gray-400 text-sm">
                        Профессиональный тюнинг и детейлинг в Петрозаводске
                    </p>
                </div>
                <div>
                    <h3 class="text-white mb-4">Контакты</h3>
                    <p class="text-gray-400 text-sm">Телефон: +7 (921) 228-23-01</p>
                    <p class="text-gray-400 text-sm">г. Петрозаводск, Гвардейская ул., 20</p>
                </div>
                <div>
                    <h3 class="text-white mb-4">Режим работы</h3>
                    <p class="text-gray-400 text-sm">Понедельник - Пятница: 10:00 - 18:30</p>
                    <p class="text-gray-400 text-sm">Суббота: 12:00 - 17:00</p>
                    <p class="text-gray-400 text-sm">Воскресенье: 12:00 - 17:00</p>
                </div>
            </div>
            <div class="border-t border-red-900/20 mt-8 pt-8 text-center text-gray-500 text-sm">
                <p>© 2012-2026 Avto-Декор. Все права защищены.</p>
                <p class="mt-2">
                    <a href="{% url 'core:privacy' %}" class="text-red-700 hover:text-red-600 transition-colors">Политика конфиденциальности</a>
                    <span class="mx-2">|</span>
                    Сайт разработан компанией <a href="https://atii.ru" target="_blank" rel="noopener noreferrer" class="text-red-700 hover:text-red-600 transition-colors">АТИИ</a>
                </p>
            </div>
        </div>
    </footer>

    <!-- Modal: Contact Form -->
    <div id="contact-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
        <div class="bg-gradient-to-br from-gray-800 to-gray-900 rounded-lg border border-red-900/20 max-w-2xl w-full max-h-[90vh] overflow-y-auto">
            <div class="sticky top-0 bg-gradient-to-br from-gray-800 to-gray-900 border-b border-red-900/20 px-6 py-4 flex items-center justify-between">
                <h2 class="text-2xl text-white font-bold">Оставить заявку</h2>
                <button 
                    onclick="closeContactModal()"
                    class="text-gray-400 hover:text-white transition-colors"
                    aria-label="Закрыть"
                >
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="p-6">
                <div id="modal-messages" class="mb-6 hidden"></div>
                
                <form id="contact-modal-form" class="space-y-6">
                    {% csrf_token %}
                    
                    <!-- Name -->
                    <div>
                        <label for="modal-name" class="block text-white mb-2">
                            Ваше имя <span class="text-red-500">*</span>
                        </label>
                        <input
                            type="text"
                            id="modal-name"
                            name="name"
                            required
                            class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-700 focus:ring-1 focus:ring-red-700"
                            placeholder="Введите ваше имя"
                        />
                        <div id="modal-name-error" class="mt-1 text-red-400 text-sm hidden"></div>
                    </div>
                    
                    <!-- Phone -->
                    <div>
                        <label for="modal-phone" class="block text-white mb-2">
                            Телефон <span class="text-red-500">*</span>
                        </label>
                        <input
                            type="tel"
                            id="modal-phone"
                            name="phone"
                            required
                            value="+7"
                            class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-700 focus:ring-1 focus:ring-red-700"
                            placeholder="+7 (999) 123-45-67"
                        />
                        <div id="modal-phone-error" class="mt-1 text-red-400 text-sm hidden"></div>
                    </div>
                    
                    <!-- Email -->
                    <div>
                        <label for="modal-email" class="block text-white mb-2">
                            Email (необязательно)
                        </label>
                        <input
                            type="email"
                            id="modal-email"
                            name="email"
                            class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-700 focus:ring-1 focus:ring-red-700"
                            placeholder="example@mail.ru"
                        />
                        <div id="modal-email-error" class="mt-1 text-red-400 text-sm hidden"></div>
                    </div>
                    
                    <!-- Message -->
                    <div>
                        <label for="modal-message" class="block text-white mb-2">
                            Сообщение <span class="text-red-500">*</span>
                        </label>
                        <textarea
                            id="modal-message"
                            name="message"
                            required
                            rows="5"
                            class="w-full px-4 py-3 bg-gray-800/50 border border-gray-700 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-red-700 focus:ring-1 focus:ring-red-700 resize-none"
                            placeholder="Опишите вашу заявку или вопрос..."
                        ></textarea>
                        <div id="modal-message-error" class="mt-1 text-red-400 text-sm hidden"></div>
                    </div>
                    
                    <!-- Privacy Consent -->
                    <div>
                        <label class="flex items-start gap-3 cursor-pointer">
                            <input
                                type="checkbox"
                                id="modal-privacy-consent"
                                name="privacy_consent"
                                required
                                class="mt-1 w-4 h-4 text-red-700 bg-gray-800 border-gray-700 rounded focus:ring-red-700 focus:ring-2"
                            />
                            <span class="text-gray-300 text-sm">
                                Я согласен(а) на <a href="{% url 'core:privacy' %}" target="_blank" class="text-red-700 hover:text-red-600 underline">обработку персональных данных</a> <span class="text-red-500">*</span>
                            </span>
                        </label>
                        <div id="modal-privacy-consent-error" class="mt-1 text-red-400 text-sm hidden"></div>
                    </div>
                    
                    <!-- Submit Button -->
                    <button
                        type="submit"
                        id="modal-submit-btn"
                        class="w-full bg-red-700 hover:bg-red-800 transition-colors px-6 py-3 rounded-lg text-lg font-medium text-white"
                    >
                        Отправить заявку
                    </button>
                </form>
            </div>
        </div>
    </div>

    {% block extra_js %}{% endblock %}
    
    <!-- Cookie Consent Banner -->
    <div id="cookie-consent-banner" class="hidden fixed bottom-0 left-0 right-0 z-50 bg-gradient-to-r from-gray-900 to-black border-t border-red-900/20 p-4 md:p-6">
        <div class="container mx-auto max-w-6xl">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <div class="flex-1 text-gray-300 text-sm md:text-base">
                    <p>
                        Мы используем файлы cookie для улучшения работы сайта и анализа посещаемости. 
                        Продолжая использовать сайт, вы соглашаетесь с использованием файлов cookie. 
                        <a href="{% url 'core:privacy' %}" target="_blank" class="text-red-700 hover:text-red-600 underline">Подробнее</a>
                    </p>
                </div>
                <button
                    onclick="acceptCookies()"
                    class="bg-red-700 hover:bg-red-800 transition-colors px-6 py-3 rounded-lg text-white font-medium whitespace-nowrap"
                >
                    Принять
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Cookie Consent
        function acceptCookies() {
            localStorage.setItem('cookieConsent', 'accepted');
            document.getElementById('cookie-consent-banner').classList.add('hidden');
        }
        
        // Проверяем согласие при загрузке страницы
        document.addEventListener('DOMContentLoaded', function() {
            const consent = localStorage.getItem('cookieConsent');
            if (!consent) {
                const banner = document.getElementById('cookie-consent-banner');
                if (banner) {
                    banner.classList.remove('hidden');
                }
            }
        });
    </script>
    
    <script>
        // Mobile Menu Toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const menuIcon = document.getElementById('menu-icon');
        const closeIcon = document.getElementById('close-icon');
        
        function toggleMobileMenu() {
            const isHidden = mobileMenu.classList.contains('hidden');
            
            if (isHidden) {
                mobileMenu.classList.remove('hidden');
                menuIcon.classList.add('hidden');
                closeIcon.classList.remove('hidden');
            } else {
                mobileMenu.classList.add('hidden');
                menuIcon.classList.remove('hidden');
                closeIcon.classList.add('hidden');
            }
        }
        
        function closeMobileMenu() {
            mobileMenu.classList.add('hidden');
            menuIcon.classList.remove('hidden');
            closeIcon.classList.add('hidden');
        }
        
        if (mobileMenuButton) {
            mobileMenuButton.addEventListener('click', toggleMobileMenu);
        }
        
        // Закрываем меню при клике вне его
        document.addEventListener('click', function(event) {
            const isClickInsideMenu = mobileMenu.contains(event.target);
            const isClickOnButton = mobileMenuButton && mobileMenuButton.contains(event.target);
            
            if (!isClickInsideMenu && !isClickOnButton && !mobileMenu.classList.contains('hidden')) {
                closeMobileMenu();
            }
        });
        
        // Закрываем меню при изменении размера окна (если перешли на desktop)
        window.addEventListener('resize', function() {
            if (window.innerWidth >= 768) {
                closeMobileMenu();
            }
        });
        
        // Contact Modal Functions - делаем глобальными
        window.openContactModal = function() {
            const modal = document.getElementById('contact-modal');
            if (modal) {
                modal.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        };
        
        window.closeContactModal = function() {
            const modal = document.getElementById('contact-modal');
            if (modal) {
                modal.classList.add('hidden');
                document.body.style.overflow = '';
                // Очищаем форму и сообщения
                const form = document.getElementById('contact-modal-form');
                if (form) {
                    form.reset();
                    // Возвращаем +7 в поле телефона
                    const phoneInput = document.getElementById('modal-phone');
                    if (phoneInput) {
                        phoneInput.value = '+7';
                    }
                }
                const messagesDiv = document.getElementById('modal-messages');
                if (messagesDiv) {
                    messagesDiv.classList.add('hidden');
                    messagesDiv.innerHTML = '';
                }
                // Очищаем ошибки
                ['name', 'phone', 'email', 'message'].forEach(field => {
                    const errorDiv = document.getElementById(`modal-${field}-error`);
                    if (errorDiv) {
                        errorDiv.classList.add('hidden');
                        errorDiv.textContent = '';
                    }
                });
            }
        };
        
        // Закрываем модальное окно при клике вне его
        document.addEventListener('DOMContentLoaded', function() {
            const modal = document.getElementById('contact-modal');
            if (modal) {
                modal.addEventListener('click', function(event) {
                    if (event.target === modal) {
                        window.closeContactModal();
                    }
                });
            }
            
            // Закрываем модальное окно по Escape
            document.addEventListener('keydown', function(event) {
                if (event.key === 'Escape') {
                    const modal = document.getElementById('contact-modal');
                    if (modal && !modal.classList.contains('hidden')) {
                        window.closeContactModal();
                    }
                }
            });
            
            // Обработка отправки формы
            const form = document.getElementById('contact-modal-form');
            if (form) {
                form.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const submitBtn = document.getElementById('modal-submit-btn');
                    const messagesDiv = document.getElementById('modal-messages');
                    
                    // Очищаем предыдущие ошибки и сообщения
                    if (messagesDiv) {
                        messagesDiv.classList.add('hidden');
                        messagesDiv.innerHTML = '';
                    }
                    ['name', 'phone', 'email', 'message', 'privacy_consent'].forEach(field => {
                        const errorDiv = document.getElementById(`modal-${field}-error`);
                        if (errorDiv) {
                            errorDiv.classList.add('hidden');
                            errorDiv.textContent = '';
                        }
                    });
                    
                    // Блокируем кнопку
                    if (submitBtn) {
                        submitBtn.disabled = true;
                        submitBtn.textContent = 'Отправка...';
                    }
                    
                    // Собираем данные формы
                    const formData = new FormData(form);
                    
                    try {
                        const response = await fetch('{% url "contacts:submit_form_ajax" %}', {
                            method: 'POST',
                            body: formData,
                            headers: {
                                'X-Requested-With': 'XMLHttpRequest',
                            }
                        });
                        
                        const data = await response.json();
                        
                        if (data.success) {
                            // Успешная отправка
                            if (messagesDiv) {
                                messagesDiv.className = 'mb-6 p-4 rounded-lg bg-green-900/30 border border-green-700/50 text-green-300';
                                messagesDiv.textContent = data.message;
                                messagesDiv.classList.remove('hidden');
                            }
                            
                            // Очищаем форму
                            form.reset();
                            // Возвращаем +7 в поле телефона
                            const phoneInput = document.getElementById('modal-phone');
                            if (phoneInput) {
                                phoneInput.value = '+7';
                            }
                            
                            // Закрываем модальное окно через 2 секунды
                            setTimeout(() => {
                                window.closeContactModal();
                            }, 2000);
                        } else {
                            // Ошибки валидации
                            if (data.errors) {
                                Object.keys(data.errors).forEach(field => {
                                    const errorDiv = document.getElementById(`modal-${field}-error`);
                                    if (errorDiv) {
                                        errorDiv.textContent = data.errors[field][0];
                                        errorDiv.classList.remove('hidden');
                                    }
                                });
                            }
                            
                            // Общее сообщение об ошибке
                            if (data.message && messagesDiv) {
                                messagesDiv.className = 'mb-6 p-4 rounded-lg bg-red-900/30 border border-red-700/50 text-red-300';
                                messagesDiv.textContent = data.message;
                                messagesDiv.classList.remove('hidden');
                            }
                        }
                    } catch (error) {
                        if (messagesDiv) {
                            messagesDiv.className = 'mb-6 p-4 rounded-lg bg-red-900/30 border border-red-700/50 text-red-300';
                            messagesDiv.textContent = 'Произошла ошибка при отправке заявки. Пожалуйста, попробуйте позвонить нам по телефону.';
                            messagesDiv.classList.remove('hidden');
                        }
                    } finally {
                        if (submitBtn) {
                            submitBtn.disabled = false;
                            submitBtn.textContent = 'Отправить заявку';
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>

