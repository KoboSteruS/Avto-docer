{% extends 'base.html' %}

{% block title %}Главная - Avto-Декор{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="relative h-[600px] flex items-center justify-center overflow-hidden">
    <div 
        class="absolute inset-0 bg-cover bg-center bg-no-repeat opacity-40"
        style="background-image: url('https://images.unsplash.com/photo-1599912027667-755b68b4dd3b?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=M3w3Nzg4Nzd8MHwxfHNlYXJjaHwxfHxsdXh1cnklMjBjYXIlMjBpbnRlcmlvcnxlbnwxfHx8fDE3NjcyNjQ0NTh8MA&ixlib=rb-4.1.0&q=80&w=1080&utm_source=figma&utm_medium=referral')"
    ></div>
    <div class="absolute inset-0 bg-gradient-to-b from-black/60 to-black/80"></div>
    
    <div class="container mx-auto px-4 relative z-10 text-center">
        <h1 class="text-5xl md:text-7xl mb-6 text-white">
            Тюнинг-ателье <br />
            <span class="text-red-700">Avto-Декор</span>
        </h1>
        <p class="text-xl md:text-2xl text-gray-300 mb-4 max-w-3xl mx-auto font-medium">
            Тюнинг. Стиль. Индивидуальность.
        </p>
        <p class="text-lg md:text-xl text-gray-400 mb-8 max-w-3xl mx-auto italic">
            Ветер, визг колёс и мощный бас колонок, диски 20 дюймов, кожаный салон. 
            На Avto-Декор не встретишь ты болонок: тюнинг, стиль и мощь – готовься взять разгон!
        </p>
        <div class="flex flex-col sm:flex-row items-center justify-center gap-4 mb-8">
            <div class="flex items-center gap-2 text-gray-300">
                <svg class="w-5 h-5 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                </svg>
                <span>Петрозаводск, ул. Гвардейская 20</span>
            </div>
            <div class="flex items-center gap-2 text-gray-300">
                <svg class="w-5 h-5 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                </svg>
                <span>8 (8142) 28-23-01</span>
            </div>
        </div>
        <a
            href="{% url 'services:list' %}"
            class="inline-flex items-center gap-2 bg-red-700 hover:bg-red-800 transition-colors px-8 py-4 rounded-lg text-lg"
        >
            Наши Услуги
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
    </div>
</section>

<!-- Services Preview -->
<section class="container mx-auto px-4 py-20">
    <h2 class="text-4xl text-center mb-12 text-white">
        Наши <span class="text-red-700">Услуги</span>
    </h2>
    
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for service in services %}
        {% load static %}
        {% comment %}Маппинг изображений для услуг{% endcomment %}
        {% if service.slug == 'avtotyuning' %}
            {% static 'img/tuning.jpg' as service_bg_image %}
        {% elif service.slug == 'akvaprint' %}
            {% static 'img/aquaprint-7777.jpg' as service_bg_image %}
        {% elif service.slug == 'aerografiya' %}
            {% static 'img/aero.jpg' as service_bg_image %}
        {% elif service.slug == 'vosstanovlenie-air-bag' %}
            {% static 'img/airbag.jpg' as service_bg_image %}
        {% elif service.slug == 'dekorativnaya-otdelka-salona' %}
            {% static 'img/derevo.jpg' as service_bg_image %}
        {% elif service.slug == 'detejling' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'zolocheni' %}
            {% static 'img/gold.jpg' as service_bg_image %}
        {% elif service.slug == 'kozhgalantereya' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'nanokeramika' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'music' %}
            {% static 'img/music.jpg' as service_bg_image %}
        {% elif service.slug == 'pereoborudovanie-salonov' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'peretyazhka-salona' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'polirovka-avtomobilya' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'restavratsiya-mebeli' %}
            {% static 'img/mebel.jpg' as service_bg_image %}
        {% elif service.slug == 'signalizatsiya' %}
            {% static 'img/signal.jpg' as service_bg_image %}
        {% elif service.slug == 'ustanovka-podogreva-sidenij-i-rulya' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'ustanovka-predvpuskovogo-podogrevatelya-dvigatelya' %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% elif service.slug == 'flokirovaniy' %}
            {% static 'img/flok.jpg' as service_bg_image %}
        {% elif service.slug == 'hrom' %}
            {% static 'img/hrom.jpg' as service_bg_image %}
        {% elif service.slug == 'prof-khimchistka' %}
            {% static 'img/him.jpg' as service_bg_image %}
        {% elif service.slug == 'chip-tyuning' %}
            {% static 'img/tuning.jpg' as service_bg_image %}
        {% elif service.slug == 'vibro-shumoizolyatsiya' %}
            {% static 'img/vibro.jpg' as service_bg_image %}
        {% else %}
            {% static 'img/salon_small.jpg' as service_bg_image %}
        {% endif %}
        
        <a href="{% url 'services:detail' slug=service.slug %}" class="group relative overflow-hidden rounded-lg border border-red-900/20 hover:border-red-700/50 transition-all hover:scale-105 block">
            <!-- Фоновое изображение -->
            <div class="absolute inset-0 bg-cover bg-center opacity-50 group-hover:opacity-60 transition-opacity duration-500" style="background-image: url('{{ service_bg_image }}');"></div>
            <div class="absolute inset-0 bg-gradient-to-br from-gray-900/75 via-gray-900/70 to-gray-800/75"></div>
            
            <!-- Контент -->
            <div class="relative h-48 flex items-center justify-center p-6">
                <div class="text-center">
                    <h3 class="text-xl mb-2 text-white font-semibold">{{ service.title }}</h3>
                    <p class="text-gray-300 text-sm">{{ service.short_description|default:service.description|truncatewords:12 }}</p>
                </div>
            </div>
        </a>
        {% empty %}
        <div class="col-span-full text-center text-gray-400">
            <p>Услуги будут добавлены в ближайшее время</p>
        </div>
        {% endfor %}
    </div>

    <div class="text-center mt-12">
        <a
            href="{% url 'services:list' %}"
            class="inline-flex items-center gap-2 bg-red-700 hover:bg-red-800 transition-colors px-6 py-3 rounded-lg"
        >
            Все Услуги
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
    </div>
</section>

<!-- About Company -->
<section class="container mx-auto px-4 py-20">
    <div class="max-w-4xl mx-auto">
        <h2 class="text-4xl text-center mb-6 text-white">
            О <span class="text-red-700">компании</span>
        </h2>
        <p class="text-xl text-center text-gray-300 mb-12 max-w-3xl mx-auto">
            Более 10 лет студия Avto-Декор создаёт автомобильные интерьеры, где сочетаются стиль, комфорт и характер.
        </p>
        <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-8 md:p-12 border border-red-900/20">
            <p class="text-gray-300 text-lg leading-relaxed mb-6">
                Наши мастера работают с кожей Nappa, алькантарой и другими премиум-материалами, воплощая любые идеи заказчиков — от классики до эксклюзива. 
                Мы были первыми и остаемся лучшими в тюнинге салона автомобиля в Петрозаводске.
            </p>
            <p class="text-gray-300 text-lg leading-relaxed">
                Сотни реализованных проектов, высококвалифицированные специалисты и непревзойденное качество работы — 
                вот что делает нас выбором тех, кому важно получать высококачественный, полезный сервис.
            </p>
        </div>
    </div>
</section>

<!-- Why Choose Us -->
<section class="bg-black/40 py-20">
    <div class="container mx-auto px-4">
        <h2 class="text-4xl text-center mb-12 text-white">
            Почему выбирают <span class="text-red-700">нас</span>
        </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 max-w-6xl mx-auto">
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-6 border border-red-900/20 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-red-700/20 rounded-full mb-4">
                    <svg class="w-8 h-8 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                </div>
                <h3 class="text-xl mb-2 text-white">Опыт</h3>
                <p class="text-gray-400">Более 10 лет успешной работы и сотни реализованных проектов</p>
            </div>
            
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-6 border border-red-900/20 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-red-700/20 rounded-full mb-4">
                    <svg class="w-8 h-8 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                    </svg>
                </div>
                <h3 class="text-xl mb-2 text-white">Технологии</h3>
                <p class="text-gray-400">Проверенные временем процессы и современные решения для салонов премиум-класса</p>
            </div>
            
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-6 border border-red-900/20 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-red-700/20 rounded-full mb-4">
                    <svg class="w-8 h-8 text-red-700" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                    </svg>
                </div>
                <h3 class="text-xl mb-2 text-white">Качество</h3>
                <p class="text-gray-400">Каждый шов, каждая деталь под контролем мастера. Контроль качества на всех этапах</p>
            </div>
            
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-6 border border-red-900/20 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-red-700/20 rounded-full mb-4">
                    <svg class="w-8 h-8 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                    </svg>
                </div>
                <h3 class="text-xl mb-2 text-white">Ответственность</h3>
                <p class="text-gray-400">Гарантируем сохранность вашего автомобиля и идеальный результат работы</p>
            </div>
            
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-6 border border-red-900/20 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-red-700/20 rounded-full mb-4">
                    <svg class="w-8 h-8 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                    </svg>
                </div>
                <h3 class="text-xl mb-2 text-white">Знания</h3>
                <p class="text-gray-400">Благодаря многолетнему опыту, мы знаем всё об интерьерах машин</p>
            </div>
            
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-6 border border-red-900/20 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-red-700/20 rounded-full mb-4">
                    <svg class="w-8 h-8 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                    </svg>
                </div>
                <h3 class="text-xl mb-2 text-white">Безопасность</h3>
                <p class="text-gray-400">Ваш автомобиль будет находиться в комфортных условиях с хорошей охраной</p>
            </div>
        </div>
    </div>
</section>

<!-- Works Preview -->
{% if works %}
<section class="container mx-auto px-4 py-20">
    <h2 class="text-4xl text-center mb-12 text-white">
        Наши <span class="text-red-700">Работы</span>
    </h2>
    
    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 md:gap-6 mx-auto" id="works-carousel" style="width: 90%; max-width: 1200px;">
        <style>
            @media (min-width: 768px) {
                #works-carousel {
                    width: 70% !important;
                }
            }
        </style>
        <!-- Первые 6 работ отображаются сразу -->
        {% for work in works|slice:":6" %}
        <div class="work-item group relative overflow-hidden rounded-xl border-2 border-gray-800 hover:border-red-700 transition-all duration-300 hover:shadow-2xl hover:shadow-red-900/20 aspect-square">
            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent z-10"></div>
            <!-- Основное изображение -->
            <img
                src="{{ work.image.url }}"
                alt="Работа {{ forloop.counter }}"
                class="work-image-main w-full h-full object-cover group-hover:scale-110 transition-transform duration-700 ease-out"
                data-work-index="{{ forloop.counter0 }}"
                loading="lazy"
            />
            <!-- Изображение для crossfade -->
            <img
                src="{{ work.image.url }}"
                alt="Работа {{ forloop.counter }}"
                class="work-image-overlay w-full h-full object-cover group-hover:scale-110 transition-transform duration-700 ease-out absolute inset-0 opacity-0"
                loading="lazy"
            />
            <div class="absolute bottom-0 left-0 right-0 p-3 z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
                <p class="text-white text-sm font-medium truncate">Наша работа</p>
            </div>
        </div>
        {% endfor %}
    </div>

    <div class="text-center mt-12">
        <a
            href="{% url 'works:list' %}"
            class="inline-flex items-center gap-2 bg-red-700 hover:bg-red-800 transition-all duration-300 px-8 py-4 rounded-lg text-lg font-medium shadow-lg shadow-red-900/30 hover:shadow-xl hover:shadow-red-900/40 hover:scale-105"
        >
            Все Работы
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
            </svg>
        </a>
    </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const worksData = [
        {% for work in works %}
        {
            image: "{{ work.image.url }}",
            index: {{ forloop.counter0 }}
        }{% if not forloop.last %},{% endif %}
        {% endfor %}
    ];
    
    if (worksData.length < 6) return; // Нужно минимум 6 работ
    
    const carousel = document.getElementById('works-carousel');
    const workItems = carousel.querySelectorAll('.work-item');
    let currentIndices = [0, 1, 2, 3, 4, 5]; // Индексы текущих отображаемых работ
    
    function getRandomWorkIndex() {
        // Получаем случайный индекс из всех доступных работ
        // Если работ больше 6, стараемся не повторять текущие
        if (worksData.length > 6) {
            const availableIndices = worksData
                .map((_, idx) => idx)
                .filter(idx => !currentIndices.includes(idx));
            
            if (availableIndices.length > 0) {
                return availableIndices[Math.floor(Math.random() * availableIndices.length)];
            }
        }
        // Если работ <= 6 или все уже используются, возвращаем любой случайный
        return Math.floor(Math.random() * worksData.length);
    }
    
    function rotateWork() {
        // Случайно выбираем позицию для замены (хаотично)
        const randomPosition = Math.floor(Math.random() * 6);
        const itemToChange = workItems[randomPosition];
        const imgMain = itemToChange.querySelector('.work-image-main');
        const imgOverlay = itemToChange.querySelector('.work-image-overlay');
        
        // Получаем случайный индекс (все фотки могут переливаться)
        const newIndex = getRandomWorkIndex();
        
        // Обновляем текущий индекс
        currentIndices[randomPosition] = newIndex;
        
        // Crossfade эффект: загружаем новое изображение в overlay
        imgOverlay.src = worksData[newIndex].image;
        imgOverlay.alt = 'Работа ' + (newIndex + 1);
        imgOverlay.setAttribute('data-work-index', newIndex);
        
        // Показываем overlay (новое изображение), скрываем main (старое)
        imgOverlay.style.opacity = '1';
        imgOverlay.style.transition = 'opacity 0.5s ease-in-out';
        imgMain.style.opacity = '0';
        imgMain.style.transition = 'opacity 0.5s ease-in-out';
        
        // После завершения перехода, меняем местами
        setTimeout(() => {
            // Меняем src основного изображения
            imgMain.src = worksData[newIndex].image;
            imgMain.alt = 'Работа ' + (newIndex + 1);
            imgMain.setAttribute('data-work-index', newIndex);
            
            // Сбрасываем opacity
            imgMain.style.opacity = '1';
            imgOverlay.style.opacity = '0';
        }, 500);
    }
    
    // Запускаем ротацию каждые 1.2 секунды (быстро, но с плавным переходом)
    setInterval(rotateWork, 1200);
});
</script>
{% endif %}

<!-- Materials Section -->
<section class="container mx-auto px-4 py-20">
    <div class="max-w-4xl mx-auto">
        <h2 class="text-4xl text-center mb-6 text-white">
            Премиум <span class="text-red-700">материалы</span>
        </h2>
        <p class="text-xl text-center text-gray-300 mb-12 max-w-3xl mx-auto">
            Работаем с лучшими материалами для создания неповторимого интерьера
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-8 border border-red-900/20">
                <h3 class="text-2xl text-white mb-4">Кожа Nappa</h3>
                <p class="text-gray-300 leading-relaxed">
                    Тончайшая натуральная кожа подарит особенный комфорт. Сидения, обтянутые ею, манят своими «объятиями». 
                    Терпкий, изысканный аромат кожи пьянит, усиливает ощущения шика и комфорта.
                </p>
            </div>
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-8 border border-red-900/20">
                <h3 class="text-2xl text-white mb-4">Алькантара</h3>
                <p class="text-gray-300 leading-relaxed">
                    Великолепная ткань не уступает по комфортности коже. Разнообразная палитра материала позволит создать 
                    невероятной красоты дизайн-проект, особенный, неповторимый.
                </p>
            </div>
        </div>
    </div>
</section>

<!-- CTA Section -->
<section class="container mx-auto px-4 py-20">
    <div class="bg-gradient-to-r from-red-900/30 to-red-700/30 rounded-2xl p-12 text-center border border-red-700/50">
        <h2 class="text-4xl mb-4 text-white">Готовы преобразить свой автомобиль?</h2>
        <p class="text-xl text-gray-300 mb-2">
            Каждый проект — это история о вкусе и внимании к деталям.
        </p>
        <p class="text-lg text-gray-400 mb-8">
            Вы задумываете, мы реализуем. Avto-Декор — когда важно качество в каждой детали.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a
                href="{% url 'contacts:contacts' %}"
                class="inline-flex items-center gap-2 bg-red-700 hover:bg-red-800 transition-colors px-8 py-4 rounded-lg text-lg"
            >
                Связаться с нами
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
            <a
                href="tel:88142282301"
                class="inline-flex items-center gap-2 bg-gray-800 hover:bg-gray-700 transition-colors px-8 py-4 rounded-lg text-lg"
            >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                </svg>
                8 (8142) 28-23-01
            </a>
        </div>
    </div>
</section>
{% endblock %}

