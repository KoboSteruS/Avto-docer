{% extends 'base.html' %}
{% load static %}
{% load content_tags %}

{% block title %}Контакты - Avto-Декор{% endblock %}

{% block extra_css %}
<style>
    #map {
        border-radius: 0.5rem;
    }
    /* Стили для балуна Яндекс.Карт */
    .ymaps-balloon {
        border-radius: 0.5rem;
    }
    .ymaps-balloon__content {
        padding: 15px;
    }
</style>
{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-20">
    <h1 class="text-5xl text-center mb-6 text-white">
        {% get_content 'contacts' 'title' '<span class="text-red-700">Контакты</span>' %}
    </h1>
    <p class="text-xl text-center text-gray-400 mb-16 max-w-3xl mx-auto">
        {% get_content 'contacts' 'subtitle' 'Свяжитесь с нами для консультации и записи на обслуживание' %}
    </p>

    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
        <!-- Contact Information -->
        <div class="space-y-8">
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-8 border border-red-900/20">
                <h2 class="text-2xl mb-6 text-white">{% get_content 'contacts' 'info_title' 'Контактная информация' %}</h2>

                <div class="space-y-6">
                    <!-- Phone -->
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-red-700/20 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                        </div>
                        <div>
                            <div class="text-white mb-1">Телефон</div>
                            <a
                                href="tel:88142282380"
                                class="text-gray-400 hover:text-red-700 transition-colors"
                            >
                                8(8142) 28-23-80
                            </a>
                        </div>
                    </div>

                    <!-- Address -->
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-red-700/20 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path>
                            </svg>
                        </div>
                        <div>
                            <div class="text-white mb-1">Адрес</div>
                            <div class="text-gray-400">
                                г. Петрозаводск, Гвардейская ул., 10
                            </div>
                        </div>
                    </div>

                    <!-- Email -->
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-red-700/20 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                            </svg>
                        </div>
                        <div>
                            <div class="text-white mb-1">Email</div>
                            <a
                                href="mailto:info@avto-decor.ru"
                                class="text-gray-400 hover:text-red-700 transition-colors"
                            >
                                info@avto-decor.ru
                            </a>
                        </div>
                    </div>

                    <!-- Working Hours -->
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-red-700/20 rounded-lg flex items-center justify-center">
                            <svg class="w-6 h-6 text-red-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                        </div>
                        <div>
                            <div class="text-white mb-2">Режим работы</div>
                            <div class="text-gray-400 space-y-1">
                                <div>Понедельник - Пятница: 9:00 - 18:00</div>
                                <div>Суббота: 10:00 - 16:00</div>
                                <div>Воскресенье: выходной</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Form -->
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-8 border border-red-900/20">
                <h2 class="text-2xl mb-6 text-white">{% get_content 'contacts' 'form_title' 'Оставить заявку' %}</h2>
                
                {% if messages %}
                <div class="mb-6">
                    {% for message in messages %}
                    <div class="p-4 rounded-lg {% if message.tags == 'success' %}bg-green-900/30 border border-green-700/50 text-green-300{% else %}bg-red-900/30 border border-red-700/50 text-red-300{% endif %}">
                        {{ message }}
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                
                <form method="post" action="{% url 'contacts:contacts' %}" class="space-y-6">
                    {% csrf_token %}
                    
                    <!-- Name -->
                    <div>
                        <label for="{{ form.name.id_for_label }}" class="block text-white mb-2">
                            {{ form.name.label }}
                        </label>
                        {{ form.name }}
                        {% if form.name.errors %}
                        <div class="mt-1 text-red-400 text-sm">
                            {{ form.name.errors }}
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Phone -->
                    <div>
                        <label for="{{ form.phone.id_for_label }}" class="block text-white mb-2">
                            {{ form.phone.label }}
                        </label>
                        {{ form.phone }}
                        {% if form.phone.errors %}
                        <div class="mt-1 text-red-400 text-sm">
                            {{ form.phone.errors }}
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Email -->
                    <div>
                        <label for="{{ form.email.id_for_label }}" class="block text-white mb-2">
                            {{ form.email.label }}
                        </label>
                        {{ form.email }}
                        {% if form.email.errors %}
                        <div class="mt-1 text-red-400 text-sm">
                            {{ form.email.errors }}
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Message -->
                    <div>
                        <label for="{{ form.message.id_for_label }}" class="block text-white mb-2">
                            {{ form.message.label }}
                        </label>
                        {{ form.message }}
                        {% if form.message.errors %}
                        <div class="mt-1 text-red-400 text-sm">
                            {{ form.message.errors }}
                        </div>
                        {% endif %}
                    </div>
                    
                    <!-- Submit Button -->
                    <button
                        type="submit"
                        class="w-full bg-red-700 hover:bg-red-800 transition-colors px-8 py-4 rounded-lg text-lg font-medium text-white"
                    >
                        Отправить заявку
                    </button>
                </form>
            </div>
            
            <!-- Additional Info -->
            <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg p-8 border border-red-900/20">
                <h2 class="text-2xl mb-4 text-white">{% get_content 'contacts' 'find_title' 'Как нас найти' %}</h2>
                <p class="text-gray-400 leading-relaxed">
                    {% get_content 'contacts' 'find_text' 'Мы находимся в центре города. Есть удобная парковка для клиентов. Рекомендуем предварительно записаться по телефону для точного планирования времени.' %}
                </p>
            </div>
        </div>

        <!-- Map -->
        <div class="bg-gradient-to-br from-gray-800/50 to-gray-900/50 rounded-lg overflow-hidden border border-red-900/20 h-[600px]">
            <div id="map" class="w-full h-full"></div>
        </div>
    </div>

    <!-- CTA -->
    <div class="mt-16 bg-gradient-to-r from-red-900/30 to-red-700/30 rounded-2xl p-12 text-center border border-red-700/50">
        <h2 class="text-3xl mb-4 text-white">{% get_content 'contacts' 'cta_title' 'Готовы обсудить ваш проект?' %}</h2>
        <p class="text-gray-300 mb-6">
            {% get_content 'contacts' 'cta_text' 'Позвоните нам или приезжайте в нашу студию для бесплатной консультации' %}
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <a
                href="tel:88142282380"
                class="inline-flex items-center justify-center gap-2 bg-red-700 hover:bg-red-800 transition-colors px-8 py-4 rounded-lg text-lg"
            >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                </svg>
                Позвонить
            </a>
            <a
                href="mailto:info@avto-decor.ru"
                class="inline-flex items-center justify-center gap-2 bg-gray-800 hover:bg-gray-700 transition-colors px-8 py-4 rounded-lg text-lg"
            >
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path>
                </svg>
                Написать
            </a>
        </div>
    </div>
</div>

<!-- Яндекс.Карты API -->
<script src="https://api-maps.yandex.ru/2.1/?lang=ru_RU"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Координаты: г. Петрозаводск, Гвардейская ул., 10
        // Примерные координаты для Петрозаводска, ул. Гвардейская
        var coordinates = [61.7850, 34.3469]; // Петрозаводск, центр города
        
        // Инициализация карты
        ymaps.ready(function() {
            var myMap = new ymaps.Map('map', {
                center: coordinates,
                zoom: 16,
                controls: ['zoomControl', 'fullscreenControl', 'typeSelector']
            }, {
                searchControlProvider: 'yandex#search'
            });

            // Геокодирование адреса для точных координат
            ymaps.geocode('Петрозаводск, Гвардейская ул., 10').then(function(res) {
                var firstGeoObject = res.geoObjects.get(0);
                if (firstGeoObject) {
                    var coords = firstGeoObject.geometry.getCoordinates();
                    myMap.setCenter(coords, 16);
                    
                    // Добавляем метку с кастомным цветом
                    var myPlacemark = new ymaps.Placemark(coords, {
                        balloonContentHeader: '<strong style="color: #dc2626;">Avto-Декор</strong>',
                        balloonContentBody: '<div style="color: #333;">г. Петрозаводск, Гвардейская ул., 10<br>Телефон: <a href="tel:88142282380" style="color: #dc2626;">8(8142) 28-23-80</a></div>',
                        balloonContentFooter: '<div style="color: #666; font-size: 12px;">Студия автомобильного интерьера</div>',
                        hintContent: 'Avto-Декор'
                    }, {
                        // Используем стандартный маркер с кастомным цветом
                        preset: 'islands#redIcon'
                    });
                    
                    myMap.geoObjects.add(myPlacemark);
                    
                    // Открываем балун при клике
                    myPlacemark.events.add('click', function() {
                        myPlacemark.balloon.open();
                    });
                } else {
                    // Если геокодирование не удалось, используем примерные координаты
                    var myPlacemark = new ymaps.Placemark(coordinates, {
                        balloonContentHeader: '<strong style="color: #dc2626;">Avto-Декор</strong>',
                        balloonContentBody: '<div style="color: #333;">г. Петрозаводск, Гвардейская ул., 10<br>Телефон: <a href="tel:88142282380" style="color: #dc2626;">8(8142) 28-23-80</a></div>',
                        balloonContentFooter: '<div style="color: #666; font-size: 12px;">Студия автомобильного интерьера</div>',
                        hintContent: 'Avto-Декор'
                    }, {
                        preset: 'islands#redIcon'
                    });
                    
                    myMap.geoObjects.add(myPlacemark);
                }
            });
        });
    });
</script>
{% endblock %}

