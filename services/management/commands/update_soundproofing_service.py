"""
Команда для обновления услуги "Шумоизоляция" с подробной информацией
"""
from django.core.management.base import BaseCommand
from services.models import Service
from loguru import logger


class Command(BaseCommand):
    """
    Команда для обновления услуги "Шумоизоляция" с детальной информацией
    """
    help = 'Обновляет услугу "Шумоизоляция" с подробной информацией'

    def handle(self, *args, **options):
        """
        Обновление услуги "Шумоизоляция"
        """
        try:
            service = Service.objects.get(slug='vibro-shumoizolyatsiya')
        except Service.DoesNotExist:
            self.stdout.write(
                self.style.ERROR('Услуга "Шумоизоляция" не найдена. Сначала создайте её через create_services.')
            )
            return

        # Краткое описание для карточек
        short_description = (
            'Шумоизоляция авто от WURTH — оптимальное решение. Защита от шума, вибрации и тепловых потерь. '
            'Немецкое качество, трёхуровневая защита одним слоем материала.'
        )

        # Основное описание
        description = (
            'Шумоизоляция авто от WURTH — оптимальное решение.\n\n'
            'Большинство современных автомобилей ведущих производителей оснащены эффективной шумоизоляцией салона. Однако отечественные авто и многие '
            'зарубежные модели эконом-класса нуждаются в дополнительной защите от шума. Кроме того, полная шумоизоляция необходима водителям, любящим '
            'слушать в дороге музыку с качественным звучанием.\n\n'
            'Шумоизоляция авто — покрытие салона или его отдельных частей материалами, хорошо поглощающими звук. Этот звук проникает как снаружи автомобиля, '
            'так и от механизмов самой машины.\n\n'
            'Качественная шумоизоляция автомобиля обеспечивает не только защиту от звуков различного происхождения, но и уменьшает вибрацию, решая вопрос '
            'удобства водителя и пассажиров в комплексе. Ещё одна вспомогательная функция шумоизоляции машины — сохранение тепла внутри салона автомобиля. '
            'Кроме того, с её помощью можно настроить работу акустической системы транспорта, снизив вибрацию динамиков.'
        )

        # Дополнительный контент (HTML поддерживается)
        content = (
            '<h2>Для чего нужна эффективная шумоизоляция</h2>\n'
            '<p>Большинство современных автомобилей ведущих производителей оснащены эффективной шумоизоляцией салона. Однако отечественные авто и многие '
            'зарубежные модели эконом-класса нуждаются в дополнительной защите от шума. Кроме того, полная шумоизоляция необходима водителям, любящим '
            'слушать в дороге музыку с качественным звучанием.</p>\n\n'
            '<p>Шумоизоляция авто — покрытие салона или его отдельных частей материалами, хорошо поглощающими звук. Этот звук проникает как снаружи автомобиля, '
            'так и от механизмов самой машины.</p>\n\n'
            '<p>Качественная шумоизоляция автомобиля обеспечивает не только защиту от звуков различного происхождения, но и уменьшает вибрацию, решая вопрос '
            'удобства водителя и пассажиров в комплексе. Ещё одна вспомогательная функция шумоизоляции машины — сохранение тепла внутри салона автомобиля. '
            'Кроме того, с её помощью можно настроить работу акустической системы транспорта, снизив вибрацию динамиков.</p>\n\n'
            '<h2>Технология и особенности укладки шумоизоляции салона</h2>\n'
            '<p>Чтобы смонтировать шумоизоляцию дверей, потолка и других частей салона, необходимо последовательно выполнить следующие операции:</p>\n'
            '<ol class="list-decimal list-inside space-y-2 mb-4">\n'
            '<li>Демонтаж салона</li>\n'
            '<li>Обезжиривание внутренней поверхности транспортного средства</li>\n'
            '<li>Укладка шумоизоляционного материала</li>\n'
            '<li>Устранение причин скрипа от механизмов и деталей авто</li>\n'
            '<li>Монтаж салона, проверка работы установленной шумоизоляции автомобиля</li>\n'
            '</ol>\n\n'
            '<p>Демонтаж салона необходимо проводить полностью, включая снятие сидений, пластика из багажника, потолочную обивку. После этого должны остаться '
            'только каркас машины и передняя панель. Эту операцию должны производить только специалисты. Неопытный человек может, выполняя её, совершить '
            'поломку или порчу салона.</p>\n\n'
            '<p>При укладке шумоизоляции необходимо учитывать, что различные зоны автомобиля покрываются разными материалами. Это объясняется, во-первых, '
            'разным типом поверхностей элементов автомобиля, а, во-вторых, тем, что каждая зона создаёт и пропускает разные виды шумов. Этот факт необходимо '
            'иметь в виду ещё на этапе выбора шумоизолирующих материалов. Чтобы не совершить ошибку, которая может привести к значительной потере эффективности, '
            'на этой стадии тоже лучше обратиться к специалистам.</p>\n\n'
            '<p>Чтобы уменьшить уровень шума, который доносится с улицы, необходимо укладывать шумоизоляцию потолка и дверей.</p>\n\n'
            '<h2>Технология и особенности укладки шумоизоляции дверей</h2>\n'
            '<p>Через двери проникает основное количество наружных звуков, так как производители почти никогда не уделяют внимание их шумоизоляции. Чтобы это исправить, '
            'надо совершить следующие действия:</p>\n'
            '<ol class="list-decimal list-inside space-y-2 mb-4">\n'
            '<li>Демонтировать двери</li>\n'
            '<li>Осторожно снять обшивку</li>\n'
            '<li>Обезжирить поверхность дверного каркаса</li>\n'
            '<li>Покрыть виброизоляционным материалом наружную часть двери (на рёбра жёсткости можно не наносить, какого-либо эффекта это не даст)</li>\n'
            '<li>Выполнить шумоизоляцию дверей</li>\n'
            '<li>Нанести немного виброизоляционного материала в дверные отверстия около колонок</li>\n'
            '<li>Установить двери обратно</li>\n'
            '</ol>\n\n'
            '<p>При выполнении этих операций необходимо точно знать место и способ крепления каждой детали к двери. Иначе потом будет невозможно её собрать. '
            'Профессионалы знают эти нюансы и выполняют шумоизоляцию двери быстро и без ошибок, а обычным автомобилистам чаще всего бывает трудно разобраться '
            'в конструктивных подробностях.</p>\n\n'
            '<h2>Технология и особенности укладки шумоизоляции потолка</h2>\n'
            '<p>Для проведения шумоизоляции потолка надо последовательно сделать следующее:</p>\n'
            '<ol class="list-decimal list-inside space-y-2 mb-4">\n'
            '<li>Демонтировать потолочную обшивку (соблюдая при этом предельную аккуратность, так как можно сломать крепления)</li>\n'
            '<li>Обезжирить образовавшуюся поверхность и очистить её от мелкого мусора</li>\n'
            '<li>Покрыть поверхность звукопоглощающим материалом</li>\n'
            '<li>Сверху нанести слой теплоизоляционного материала</li>\n'
            '<li>Аккуратно покрыть потолок обшивкой</li>\n'
            '</ol>\n\n'
            '<p>Категорически не рекомендуется наносить шумоизоляцию поверх обшивки, так как обшивка не рассчитана на такую нагрузку и может со временем отвалиться.</p>\n\n'
            '<h2>Знакомьтесь — шумоизоляция WURTH (сделано в Германии)</h2>\n'
            '<p>Чаще всего для шумоизоляции авто применяют российские материалы, так как они имеют низкую цену. Однако предпочтение стоит отдавать продукции '
            'немецкой фирмы WURTH, также представленной на отечественном рынке. Помимо традиционного немецкого качества и использования при производстве '
            'передовых технологий, шумоизоляция автомобилей WURTH обладает ещё несколькими важнейшими преимуществами.</p>\n\n'
            '<p>Главное из них то, что материал (пенополиэтилен), на основе которого производится шумоизоляция WURTH, можно укладывать только в один слой, '
            'добиваясь трёхуровневой защиты, т. е., полной шумоизоляции. Это свойство практически полностью компенсирует разницу в цене по сравнению с '
            'российскими аналогами. Дело в том, что пенополиэтилен эффективно защищает одновременно от шума, вибрации и тепловых потерь.</p>\n\n'
            '<p>Другими преимуществами шумоизоляции для салонов автомобилей WURTH являются:</p>\n'
            '<ul class="space-y-2 mb-4">\n'
            '<li class="flex items-start gap-2">\n'
            '<span class="text-red-700 mt-1">✓</span>\n'
            '<span>Отсутствие вредных для здоровья компонентов</span>\n'
            '</li>\n'
            '<li class="flex items-start gap-2">\n'
            '<span class="text-red-700 mt-1">✓</span>\n'
            '<span>Устойчивость крепления на любых поверхностях</span>\n'
            '</li>\n'
            '<li class="flex items-start gap-2">\n'
            '<span class="text-red-700 mt-1">✓</span>\n'
            '<span>Низкая удельная масса</span>\n'
            '</li>\n'
            '<li class="flex items-start gap-2">\n'
            '<span class="text-red-700 mt-1">✓</span>\n'
            '<span>Высокая влагоустойчивость</span>\n'
            '</li>\n'
            '<li class="flex items-start gap-2">\n'
            '<span class="text-red-700 mt-1">✓</span>\n'
            '<span>Устойчивость к воздействию экстремальных температур</span>\n'
            '</li>\n'
            '<li class="flex items-start gap-2">\n'
            '<span class="text-red-700 mt-1">✓</span>\n'
            '<span>Широкий ассортимент продукции, возможность применения во всех типах авто</span>\n'
            '</li>\n'
            '<li class="flex items-start gap-2">\n'
            '<span class="text-red-700 mt-1">✓</span>\n'
            '<span>Долговечность</span>\n'
            '</li>\n'
            '</ul>\n\n'
            '<h2>Вам нужна шумоизоляция в Петрозаводске? Обращайтесь к нам!</h2>\n'
            '<p>Комплексную шумоизоляцию в Петрозаводске на основе материалов WURTH можно осуществить в течение всего лишь двух дней. Профессионалы выберут '
            'именно те материалы, которые подходят для вашего авто, учитывая, как уже было сказано, разные требования для разных зон машины. После этого они '
            'произведут всю работу «под ключ» в самые сжатые сроки. У нас очень большой ассортимент качественной шумоизоляции, цена на укладку которой Вас '
            'приятно удивит.</p>'
        )

        # Список направлений/услуг
        features = (
            'Шумоизоляция от WURTH (Германия)\n'
            'Трёхуровневая защита одним слоем\n'
            'Защита от шума\n'
            'Защита от вибрации\n'
            'Защита от тепловых потерь\n'
            'Шумоизоляция дверей\n'
            'Шумоизоляция потолка\n'
            'Шумоизоляция пола\n'
            'Шумоизоляция багажника\n'
            'Виброизоляция\n'
            'Улучшение качества звука акустики\n'
            'Сохранение тепла в салоне\n'
            'Отсутствие вредных компонентов\n'
            'Устойчивость крепления на любых поверхностях\n'
            'Низкая удельная масса\n'
            'Высокая влагоустойчивость\n'
            'Устойчивость к экстремальным температурам\n'
            'Широкий ассортимент продукции\n'
            'Долговечность\n'
            'Комплексная шумоизоляция за 2 дня\n'
            'Шумоизоляция в Петрозаводске'
        )

        # Обновляем услугу
        service.short_description = short_description
        service.description = description
        service.content = content
        service.features = features
        service.save()

        logger.info(f'Услуга "{service.title}" успешно обновлена')
        self.stdout.write(
            self.style.SUCCESS(f'Услуга "{service.title}" успешно обновлена с подробной информацией')
        )
